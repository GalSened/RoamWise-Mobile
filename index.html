<!doctype html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>traveling — מדריך הטיולים החכם שלך</title>
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0066cc">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
<link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- Clear Header -->
<header class="appbar" role="banner">
  <div class="brand">
    <div class="logo">🧭</div>
    <div class="title">traveling</div>
  </div>
  <nav class="actions" aria-label="פעולות ראשיות">
    <div class="theme-toggle" id="themeToggle" title="החלף ערכת נושא"></div>
    <button id="installBtn" class="ghost ripple">התקן אפליקציה</button>
  </nav>
</header>

<main id="app" class="mobile-layout" role="main">
  
  <!-- Map View - Simple and Clean -->
  <section id="mapView" class="mobile-view" data-view="map">
    <div id="map" role="application" aria-label="מפה"></div>
    
    <!-- Clear Location Button -->
    <div class="fab-container">
      <button id="locationFab" class="fab primary bounce-on-hover float will-change-transform" title="הראה את המיקום שלי">
        <span>📍</span>
        <span class="fab-label">המיקום שלי</span>
      </button>
    </div>
    
    <!-- Simple Search -->
    <div id="quickSearch" class="quick-search">
      <input type="text" placeholder="חפש מקומות..." class="search-input">
      <button class="search-btn primary">חפש</button>
    </div>

    <!-- Map Help Overlay -->
    <div class="map-help">
      <div class="help-tip">
        💡 לחץ על 📍 כדי למצוא את המיקום שלך
      </div>
    </div>
  </section>

  <!-- Clear Search Interface -->
  <section id="searchView" class="mobile-view mobile-panel active" data-view="search">
    <div class="panel-header">
      <h2>🔍 חיפוש מקומות</h2>
      <p class="section-subtitle">מצא מקומות מעניינים בסביבתך</p>
    </div>
    
    <div class="panel-content">
      
      <!-- Quick Start Categories -->
      <section class="card highlight-card">
        <h3 class="section-title">מה אתה מחפש?</h3>
        <div class="category-grid">
          <button class="category-card featured stagger-item interactive touch-feedback" data-preset="food">
            <span class="category-icon">🍽️</span>
            <span class="category-label">מסעדות ואוכל</span>
            <span class="category-desc">מקומות טעימים</span>
          </button>
          <button class="category-card featured stagger-item interactive touch-feedback" data-preset="viewpoints">
            <span class="category-icon">🌄</span>
            <span class="category-label">נופים יפים</span>
            <span class="category-desc">תצפיות וטבע</span>
          </button>
          <button class="category-card featured stagger-item interactive touch-feedback" data-preset="activities">
            <span class="category-icon">🎯</span>
            <span class="category-label">פעילויות</span>
            <span class="category-desc">בידור ושעשועים</span>
          </button>
          <button class="category-card featured stagger-item interactive touch-feedback" data-preset="coffee">
            <span class="category-icon">☕</span>
            <span class="category-label">קפה ומתוק</span>
            <span class="category-desc">בתי קפה וקינוחים</span>
          </button>
        </div>
      </section>

      <!-- Advanced Search -->
      <section class="card">
        <h3 class="section-title">חיפוש מתקדם</h3>
        
        <!-- Free Text Search -->
        <div class="search-group">
          <label for="freeText" class="input-label">תאר מה אתה רוצה:</label>
          <input id="freeText" type="text" placeholder='לדוגמה: "פיצה טובה עם נוף" או "קפה שקט לעבודה"' class="main-input">
          <button id="thinkBtn" class="primary full-width">🤖 תן ל-AI למצוא עבורך</button>
          <div id="thinkStatus" class="status-text"></div>
        </div>

        <!-- Search Options -->
        <div class="options-group">
          <h4 class="options-title">אפשרויות חיפוש:</h4>
          
          <div class="option-row">
            <label class="toggle-label clear">
              <input type="checkbox" id="openNow" checked>
              <span class="toggle-slider"></span>
              <span class="toggle-text">רק מקומות פתוחים עכשיו</span>
            </label>
          </div>
          
          <div class="row">
            <div class="field">
              <label for="radius" class="input-label">רדיוס חיפוש:</label>
              <select id="radius" class="clear-select">
                <option value="1000">1 ק״מ - קרוב מאוד</option>
                <option value="2000">2 ק״מ - הליכה קצרה</option>
                <option value="4000" selected>4 ק״מ - נסיעה קצרה</option>
                <option value="7000">7 ק״מ - רדיוס רחב</option>
              </select>
            </div>
            <div class="field">
              <label for="minRating" class="input-label">דירוג מינימום:</label>
              <select id="minRating" class="clear-select">
                <option value="0">הכל</option>
                <option value="3.5">3.5+ ⭐⭐⭐</option>
                <option value="4.2" selected>4.2+ ⭐⭐⭐⭐</option>
                <option value="4.5">4.5+ ⭐⭐⭐⭐⭐</option>
              </select>
            </div>
          </div>
          
          <button id="searchBtn" class="secondary full-width">🔍 חפש עכשיו</button>
          <div id="status" class="status-text"></div>
        </div>
      </section>

      <!-- Weather Info -->
      <section id="weatherCard" class="card weather-card compact">
        <div class="weather-header">
          <h3 class="section-title compact">🌤️ מזג האוויר</h3>
          <button id="wxRefresh" class="ghost small">רענן</button>
        </div>
        <div class="weather-display">
          <div class="weather-main">
            <div id="wxTemp" class="wx-big">—°</div>
            <div id="wxDesc" class="wx-desc">מאתר מיקום...</div>
          </div>
          <div class="pill" id="wxHiLo">חכה...</div>
        </div>
      </section>

      <!-- Results -->
      <section id="list" class="results-section" aria-live="polite">
        <div class="results-placeholder">
          <div class="placeholder-icon">🔍</div>
          <div class="placeholder-title">התוצאות יופיעו כאן</div>
          <div class="placeholder-text">בחר קטגוריה או השתמש בחיפוש</div>
        </div>
      </section>
    </div>
  </section>

  <!-- Clear AI Assistant -->
  <section id="aiView" class="mobile-view mobile-panel" data-view="ai">
    <div class="panel-header">
      <h2>🤖 העוזר החכם שלך</h2>
      <p class="section-subtitle">קבל המלצות אישיות והתווידע עם הקול</p>
    </div>
    
    <div class="panel-content">
      
      <!-- Quick AI Actions -->
      <section class="card highlight-card">
        <h3 class="section-title">פעולות מהירות</h3>
        
        <!-- Mood Based Recommendations -->
        <div class="ai-action-group">
          <h4 class="action-title">איך אתה מרגיש היום?</h4>
          <div class="mood-grid">
            <button class="mood-card" data-mood="hungry">
              <span class="mood-icon">🍽️</span>
              <span class="mood-label">רעב</span>
            </button>
            <button class="mood-card" data-mood="adventurous">
              <span class="mood-icon">🗺️</span>
              <span class="mood-label">הרפתקני</span>
            </button>
            <button class="mood-card" data-mood="relaxed">
              <span class="mood-icon">😌</span>
              <span class="mood-label">רגוע</span>
            </button>
            <button class="mood-card" data-mood="social">
              <span class="mood-icon">👥</span>
              <span class="mood-label">חברותי</span>
            </button>
          </div>
          
          <button id="aiRecommendBtn" class="primary full-width">✨ קבל המלצות מותאמות</button>
          <div id="aiRecommendations" class="ai-recommendations" hidden></div>
        </div>
      </section>

      <!-- Voice Interface -->
      <section class="card">
        <h3 class="section-title">🎤 דיבור עם האפליקציה</h3>
        <div class="voice-interface">
          <div class="voice-instruction">
            <p>לחץ על הכפתור ודבר בעברית:</p>
            <ul class="voice-examples">
              <li>"אני רוצה לאכול משהו טעים"</li>
              <li>"תכנן לי טיול למחר"</li>
              <li>"מצא לי מקום שקט לעבודה"</li>
            </ul>
          </div>
          
          <button id="voiceBtn" class="voice-btn">
            <span class="voice-icon">🎤</span>
            <span class="voice-text">התחל לדבר</span>
          </button>
          
          <div id="voiceStatus" class="voice-status"></div>
          <div id="voiceResponse" class="ai-response" hidden></div>
        </div>
      </section>

      <!-- Notifications -->
      <div id="smartNotifications" class="notifications" hidden></div>
    </div>
  </section>

  <!-- Enhanced Trip Planning -->
  <section id="tripView" class="mobile-view mobile-panel" data-view="trip">
    <div class="panel-header gradient-bg-1">
      <h2>🗺️ תכנון טיול חכם ומתקדם</h2>
      <p class="section-subtitle">AI מתקדם יתכנן לך חוויית טיול מושלמת ומותאמת אישית</p>
    </div>
    
    <div class="panel-content">
      
      <!-- Quick Trip Templates -->
      <section class="card highlight-card">
        <h3 class="section-title">🚀 תבניות טיול מהירות</h3>
        <div class="template-grid">
          <button class="template-card stagger-item" data-template="romantic">
            <span class="template-icon">💕</span>
            <span class="template-title">טיול רומנטי</span>
            <span class="template-desc">מסעדות יפות ונופים מרהיבים</span>
          </button>
          <button class="template-card stagger-item" data-template="family">
            <span class="template-icon">👨‍👩‍👧‍👦</span>
            <span class="template-title">טיול משפחתי</span>
            <span class="template-desc">פעילויות לכל המשפחה</span>
          </button>
          <button class="template-card stagger-item" data-template="adventure">
            <span class="template-icon">🏃‍♂️</span>
            <span class="template-title">הרפתקה</span>
            <span class="template-desc">חוויות מרתקות ואתגרים</span>
          </button>
          <button class="template-card stagger-item" data-template="cultural">
            <span class="template-icon">🏛️</span>
            <span class="template-title">תרבות ואמנות</span>
            <span class="template-desc">מוזיאונים וגלריות</span>
          </button>
        </div>
      </section>

      <!-- Advanced Trip Customization -->
      <section class="card">
        <h3 class="section-title">⚙️ התאמה אישית מתקדמת</h3>
        
        <div class="trip-form">
          <!-- Smart Duration Picker -->
          <div class="form-group">
            <label for="tripDuration" class="input-label">🕐 משך הטיול</label>
            <div class="duration-picker">
              <button type="button" class="duration-option" data-duration="2">2 שעות</button>
              <button type="button" class="duration-option" data-duration="4">חצי יום</button>
              <button type="button" class="duration-option selected" data-duration="8">יום שלם</button>
              <button type="button" class="duration-option" data-duration="16">סוף שבוע</button>
              <button type="button" class="duration-option" data-duration="custom">מותאם</button>
            </div>
            <input id="customDuration" type="range" min="1" max="72" value="8" class="duration-slider" hidden>
            <div id="durationDisplay" class="duration-display">8 שעות נבחרו</div>
          </div>

          <!-- Enhanced Interests with Visual Selection -->
          <div class="form-group">
            <label class="input-label">🎯 תחומי עניין (בחר עד 4)</label>
            <div class="interests-grid">
              <div class="interest-category">
                <button type="button" data-interest="gourmet" class="interest-option">
                  <span class="interest-emoji">🍽️</span>
                  <span class="interest-name">גורמה</span>
                  <span class="interest-detail">מסעדות מעולות</span>
                </button>
              </div>
              <div class="interest-category">
                <button type="button" data-interest="nature" class="interest-option">
                  <span class="interest-emoji">🌿</span>
                  <span class="interest-name">טבע</span>
                  <span class="interest-detail">פארקים וגנים</span>
                </button>
              </div>
              <div class="interest-category">
                <button type="button" data-interest="history" class="interest-option">
                  <span class="interest-emoji">🏛️</span>
                  <span class="interest-name">היסטוריה</span>
                  <span class="interest-detail">אתרים היסטוריים</span>
                </button>
              </div>
              <div class="interest-category">
                <button type="button" data-interest="shopping" class="interest-option">
                  <span class="interest-emoji">🛍️</span>
                  <span class="interest-name">קניות</span>
                  <span class="interest-detail">חנויות ושווקים</span>
                </button>
              </div>
              <div class="interest-category">
                <button type="button" data-interest="nightlife" class="interest-option">
                  <span class="interest-emoji">🌃</span>
                  <span class="interest-name">חיי לילה</span>
                  <span class="interest-detail">ברים ומועדונים</span>
                </button>
              </div>
              <div class="interest-category">
                <button type="button" data-interest="art" class="interest-option">
                  <span class="interest-emoji">🎨</span>
                  <span class="interest-name">אמנות</span>
                  <span class="interest-detail">גלריות ומוזיאונים</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Smart Budget with Visual Indicator -->
          <div class="form-group">
            <label class="input-label">💰 תקציב משוער ליום</label>
            <div class="budget-selector">
              <input type="range" id="budgetRange" min="50" max="1000" value="300" class="budget-slider">
              <div class="budget-display">
                <span id="budgetAmount">300</span>₪ לאדם
              </div>
              <div class="budget-indicators">
                <span class="budget-label">חסכוני</span>
                <span class="budget-label">נוח</span>
                <span class="budget-label">נדיב</span>
              </div>
            </div>
          </div>

          <!-- Group Configuration -->
          <div class="row">
            <div class="form-group">
              <label for="groupType" class="input-label">👥 סוג הקבוצה</label>
              <select id="groupType" class="clear-select">
                <option value="solo">לבד</option>
                <option value="couple" selected>זוג</option>
                <option value="friends">חברים</option>
                <option value="family">משפחה</option>
                <option value="business">עסקים</option>
              </select>
            </div>
            <div class="form-group">
              <label for="groupSize" class="input-label">🔢 מספר אנשים</label>
              <input id="groupSize" type="number" min="1" max="20" value="2" class="main-input">
            </div>
          </div>

          <!-- Weather-Aware Planning -->
          <div class="form-group">
            <label class="input-label">🌤️ תכנון מבוסס מזג אוויר</label>
            <div class="weather-planning-card">
              <div class="weather-info" id="currentWeather">
                <span class="weather-icon">🌤️</span>
                <span class="weather-temp">טוען...</span>
                <span class="weather-desc">בודק תחזית</span>
              </div>
              <div class="weather-forecast" id="weatherForecast">
                <div class="forecast-day">
                  <span class="day-label">היום</span>
                  <span class="day-weather">☀️ 24°</span>
                  <span class="day-recommendation">מושלם לטיול חוץ</span>
                </div>
                <div class="forecast-day">
                  <span class="day-label">מחר</span>
                  <span class="day-weather">🌧️ 18°</span>
                  <span class="day-recommendation">מומלץ מקומות מקורים</span>
                </div>
              </div>
              <label class="preference-item weather-consideration">
                <input type="checkbox" id="weatherOptimized" checked>
                <span class="preference-text">התאם המלצות למזג האוויר</span>
              </label>
            </div>
          </div>

          <!-- Advanced Preferences -->
          <div class="form-group">
            <label class="input-label">⚡ העדפות מתקדמות</label>
            <div class="preferences-grid">
              <label class="preference-item">
                <input type="checkbox" id="accessibleOnly">
                <span class="preference-text">נגיש לנכים</span>
              </label>
              <label class="preference-item">
                <input type="checkbox" id="petFriendly">
                <span class="preference-text">ידידותי לחיות</span>
              </label>
              <label class="preference-item">
                <input type="checkbox" id="photoOps">
                <span class="preference-text">מקומות צילום</span>
              </label>
              <label class="preference-item">
                <input type="checkbox" id="localExperience">
                <span class="preference-text">חוויה מקומית</span>
              </label>
              <label class="preference-item">
                <input type="checkbox" id="indoorBackup">
                <span class="preference-text">תוכנית גיבוי מקורה</span>
              </label>
              <label class="preference-item">
                <input type="checkbox" id="flexibleTiming">
                <span class="preference-text">גמישות בזמנים</span>
              </label>
            </div>
          </div>

          <!-- AI Generation Button -->
          <button id="generateTripBtn" class="primary full-width trip-plan-btn ripple bounce-on-hover">
            <span class="btn-icon">🤖</span>
            <span class="btn-text">יצירת טיול חכם</span>
            <span class="btn-subtitle">בינה מלאכותית מתקדמת</span>
          </button>
          <div id="tripGenerationStatus" class="status-text"></div>
        </div>
      </section>

      <!-- Enhanced Trip Display -->
      <div id="enhancedTripDisplay" class="enhanced-trip-display" hidden>
        <section class="card trip-overview-card gradient-bg-1">
          <div class="trip-header">
            <h3 class="trip-title" id="generatedTripTitle">הטיול שלך מוכן!</h3>
            <div class="trip-meta-info">
              <span class="trip-duration-badge" id="tripDurationBadge">8 שעות</span>
              <span class="trip-cost-badge" id="tripCostBadge">300₪</span>
              <span class="trip-places-badge" id="tripPlacesBadge">5 מקומות</span>
            </div>
          </div>
          <div class="trip-actions">
            <button class="action-btn primary">📍 התחל ניווט</button>
            <button class="action-btn secondary">📤 שתף</button>
            <button class="action-btn ghost">📝 ערוך</button>
          </div>
        </section>

        <div id="tripItinerary" class="trip-itinerary"></div>

        <section class="card trip-insights">
          <h4 class="section-title">📊 תובנות הטיול</h4>
          <div class="insights-grid">
            <div class="insight-item">
              <span class="insight-icon">⏱️</span>
              <span class="insight-value" id="totalDuration">8 שעות</span>
              <span class="insight-label">משך כולל</span>
            </div>
            <div class="insight-item">
              <span class="insight-icon">🚶‍♂️</span>
              <span class="insight-value" id="totalDistance">3.2 ק"מ</span>
              <span class="insight-label">מרחק הליכה</span>
            </div>
            <div class="insight-item">
              <span class="insight-icon">⭐</span>
              <span class="insight-value" id="avgRating">4.3</span>
              <span class="insight-label">דירוג ממוצע</span>
            </div>
            <div class="insight-item">
              <span class="insight-icon">💰</span>
              <span class="insight-value" id="estimatedCost">280₪</span>
              <span class="insight-label">עלות משוערת</span>
            </div>
          </div>
        </section>
      </div>
      
      <!-- Smart Live Navigation -->
      <div id="smartNavigation" class="smart-navigation" hidden></div>
    </div>
  </section>

  <!-- Clear Profile -->
  <section id="profileView" class="mobile-view mobile-panel" data-view="profile">
    <div class="panel-header">
      <h2>👤 הפרופיל שלך</h2>
      <p class="section-subtitle">הסטטיסטיקות וההגדרות שלך</p>
    </div>
    
    <div class="panel-content">
      
      <!-- Stats -->
      <section class="card">
        <h3 class="section-title">📊 הפעילות שלך</h3>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-number" id="totalVisits">0</div>
            <div class="stat-label">מקומות שביקרת</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="avgRating">—</div>
            <div class="stat-label">דירוג ממוצע</div>
          </div>
        </div>
        <button id="refreshInsights" class="secondary full-width">📊 רענן נתונים</button>
      </section>

      <!-- Favorites -->
      <section class="card">
        <h3 class="section-title">⭐ המועדפים שלך</h3>
        <div id="favList" class="favorites-list">
          <div class="empty-state">
            <div class="empty-icon">⭐</div>
            <div class="empty-text">עדיין לא שמרת מקומות מועדפים</div>
          </div>
        </div>
      </section>

      <!-- Settings -->
      <section class="card">
        <h3 class="section-title">⚙️ הגדרות</h3>
        <div class="settings-list">
          <div class="setting-item">
            <label class="toggle-label clear">
              <input type="checkbox" id="notificationsEnabled" checked>
              <span class="toggle-slider"></span>
              <span class="toggle-text">התראות חכמות</span>
            </label>
          </div>
          <div class="setting-item">
            <label class="toggle-label clear">
              <input type="checkbox" id="locationTracking" checked>
              <span class="toggle-slider"></span>
              <span class="toggle-text">מעקב מיקום</span>
            </label>
          </div>
        </div>
      </section>
    </div>
  </section>

  <!-- Clear Bottom Navigation -->
  <nav id="bottomNav" class="bottom-nav" aria-label="ניווט ראשי">
    <button class="nav-item active" data-view="search" title="חיפוש מקומות">
      <span class="nav-icon">🔍</span>
      <span class="nav-label">חיפוש</span>
    </button>
    <button class="nav-item" data-view="ai" title="עוזר חכם">
      <span class="nav-icon">🤖</span>
      <span class="nav-label">AI</span>
    </button>
    <button class="nav-item" data-view="trip" title="תכנון טיול">
      <span class="nav-icon">🗺️</span>
      <span class="nav-label">טיול</span>
    </button>
    <button class="nav-item" data-view="map" title="מפה">
      <span class="nav-icon">📍</span>
      <span class="nav-label">מפה</span>
    </button>
    <button class="nav-item" data-view="profile" title="פרופיל">
      <span class="nav-icon">👤</span>
      <span class="nav-label">פרופיל</span>
    </button>
  </nav>

  <!-- Hidden elements for compatibility -->
  <div style="display: none;">
    <div id="intent">pizza</div>
    <div id="moodSelect">neutral</div>
    <div id="routeBox" hidden></div>
    <div id="placeBox"></div>
    <div id="activitiesFilters" hidden></div>
    <div id="dest"></div>
    <div id="acList" hidden></div>
    <div id="goRouteBtn"></div>
    <div id="routeMeta"></div>
    <div id="routeLinks" hidden></div>
    <div id="routeGmapsBtn"></div>
    <div id="routeWazeBtn"></div>
    <div id="travelMode">driving</div>
    <div id="aiToggle"></div>
    <div id="voiceHelpBtn"></div>
    <div id="tripToggle"></div>
    <div id="wxNext"></div>
  </div>

</main>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
<script type="module" src="app.js"></script>
</body>
</html>